<Directory {{ base_path }}/{{ item.key }}/*>
    AllowOverwrite on
    GroupOwner shared
{% if item.value.file_sharing == "write_group_read_all" %}
   Umask 002
{% elif item.value.file_sharing == "write_group_read_group" %}
    Umask 007
{% else %}{# item.value.file_sharing == "write_user_read_group" #}
    Umask 027
{% endif %}
    <Limit WRITE>
        AllowAll
    </Limit>
</Directory>
<Anonymous {{ base_path }}/{{ item.key }}/files>
    User {{ item.value.user }}
    Group {{ item.value.group }}
{% if item.value.web_access ==  'all_internet_with_password'%}
    AnonRequirePassword on
{% else %}
    AnonRequirePassword off
{% endif %}
    UseFtpUsers on
    MaxClients 10
    DisplayLogin welcome.msg
    DisplayChdir .message
    <Limit LOGIN>
      Order Allow,Deny
      Allow from all
      Deny from all
    </Limit>
    <Directory *>
        <Limit WRITE>
            DenyAll
        </Limit>
    </Directory>
</Anonymous>